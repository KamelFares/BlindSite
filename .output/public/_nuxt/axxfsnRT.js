import{f as T,m as E,l as B,B as R,c as l,a as s,d as v,t as d,z as S,A as L,v as p,F as h,r as _,h as r,i as N,o as i,_ as D}from"./BgeVWdcT.js";const z={class:"retino"},H={class:"retino__header"},P={class:"controls","aria-label":"Retinopathy controls"},U={class:"controls__label",for:"severity"},V={class:"retino__main"},q={class:"game","aria-label":"Read the label mini-game"},W={class:"game__top","aria-live":"polite"},X={class:"game__prompt"},O={class:"game__score"},Y={class:"overlay","aria-hidden":"true"},j={class:"labels"},G=["onClick"],J=T({__name:"retinopathy",setup(K){const n=r(5),f=r(0),g=r(0),A=["INSULIN","WATER","EXIT","HELP","CLINIC","PHARMACY"],c=r([]),y=r("EXIT"),m=r([]),x=r([]);let u=null,b=1;const o=(a,t)=>Math.random()*(t-a)+a,w=()=>{const a=[...A].sort(()=>Math.random()-.5);c.value=a.slice(0,4),y.value=c.value[Math.floor(Math.random()*c.value.length)]},k=()=>{const a=n.value,t=Math.round(a/10*10),e=Math.round(a/10*6);m.value=Array.from({length:t},()=>({id:b++,x:o(5,95),y:o(10,90),vx:o(-.02,.02),vy:o(-.015,.015),s:o(.8,1.8)})),x.value=Array.from({length:e},()=>({id:b++,x:o(10,90),y:o(15,85),r:o(90,180)+a*6}))},M=()=>{const t=1+n.value/10*2;for(const e of m.value)e.x+=e.vx*60*t,e.y+=e.vy*60*t,e.x<-10&&(e.x=110),e.x>110&&(e.x=-10),e.y<-10&&(e.y=110),e.y>110&&(e.y=-10);u=window.requestAnimationFrame(M)},F=a=>{a===y.value?(f.value++,w()):g.value++},I=N(()=>{const a=n.value,t=a/10*7,e=1-a/10*.25;return{"--stage-blur":`${t.toFixed(2)}px`,"--stage-contrast":e.toFixed(2),"--overlay-opacity":(.05+a/10*.22).toFixed(3)}}),$=()=>{};return E(n,()=>{k()}),B(()=>{w(),k(),typeof window<"u"&&window.dispatchEvent(new CustomEvent("blindsite:achievement",{detail:{key:"retino",text:"Patchy vision: you opened diabetic retinopathy."}})),u=window.requestAnimationFrame(M)}),R(()=>{u&&window.cancelAnimationFrame(u)}),(a,t)=>(i(),l("section",z,[s("header",H,[t[2]||(t[2]=s("h1",{class:"retino__title"},"Diabetic Retinopathy (floaters + patches)",-1)),t[3]||(t[3]=s("p",{class:"retino__lead"}," Diabetic retinopathy can cause blurry areas, dark patches, and floaters. This simulation overlays moving “floaters” and patchy blur while you try to read and click the correct label. ",-1)),s("div",P,[s("label",U,[t[1]||(t[1]=v(" Severity: ",-1)),s("strong",null,d(n.value),1)]),S(s("input",{id:"severity",class:"controls__range",type:"range",min:"0",max:"10",step:"1","onUpdate:modelValue":t[0]||(t[0]=e=>n.value=e)},null,512),[[L,n.value,void 0,{number:!0}]])])]),s("main",V,[s("section",q,[s("div",W,[s("p",X,[t[4]||(t[4]=v(" Task: Click the label ",-1)),s("strong",null,"“"+d(y.value)+"”",1)]),s("p",O,[t[5]||(t[5]=v(" Score: ",-1)),s("strong",null,d(f.value),1),t[6]||(t[6]=v(" | Mistakes: ",-1)),s("strong",null,d(g.value),1)])]),s("div",{class:"stage",style:p(I.value),onMousemove:$},[s("div",Y,[(i(!0),l(h,null,_(m.value,e=>(i(),l("div",{key:e.id,class:"floater",style:p({left:`${e.x}%`,top:`${e.y}%`,transform:`translate(-50%,-50%) scale(${e.s})`})},null,4))),128)),(i(!0),l(h,null,_(x.value,e=>(i(),l("div",{key:e.id,class:"patch",style:p({left:`${e.x}%`,top:`${e.y}%`,width:`${e.r}px`,height:`${e.r}px`,transform:"translate(-50%,-50%)"})},null,4))),128))]),s("div",j,[(i(!0),l(h,null,_(c.value,e=>(i(),l("button",{key:e,type:"button",class:"label",onClick:C=>F(e)},d(e),9,G))),128))])],36),t[7]||(t[7]=s("p",{class:"game__hint"}," Tip: Increase severity and notice how “easy reading” becomes slow and frustrating. ",-1))]),t[8]||(t[8]=s("section",{class:"info"},[s("h2",null,"What this can represent"),s("ul",null,[s("li",null,"Blurred or missing patches"),s("li",null,"Floaters that drift across the field of view"),s("li",null,"Harder reading / recognizing small text")])],-1))])]))}}),Z=D(J,[["__scopeId","data-v-a42760a8"]]);export{Z as default};
