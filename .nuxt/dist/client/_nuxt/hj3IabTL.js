import{f as R,l as U,c as A,a,d as r,g as W,t as f,x as Y,v as $,h as i,i as y,o as S,_ as z}from"./BgeVWdcT.js";const F={class:"stick-page"},K={class:"stick-page__main"},O={class:"hud","aria-live":"polite"},j={class:"hud__row"},q={class:"hud__row"},H={key:0,class:"hud__hot"},X={class:"stick-page__status","aria-live":"polite"},J={class:"mini","aria-hidden":"true"},v=11,k=3,Q=R({__name:"stick",setup(Z){const l=i(5),c=i(9),p=i([]),x=y(()=>p.value.filter(e=>e.found).length),w=i(0),u=i("Press Space to ping. Use the sound to find targets."),d=i(null),m=i(null),b=i(null),T=i(null),C=(e,t)=>{try{const n=m.value,s=b.value,o=T.value;if(!n||!s||!o)return;const g=n.createOscillator();g.type="sine",g.frequency.value=250+Math.max(0,220-e*12);const h=n.createGain(),L=Math.max(.02,Math.min(.35,.35-e*.03));h.gain.value=0,o.pan.setValueAtTime(t,n.currentTime),g.connect(h).connect(o),h.gain.setValueAtTime(1e-4,n.currentTime),h.gain.exponentialRampToValueAtTime(L,n.currentTime+.02),h.gain.exponentialRampToValueAtTime(1e-4,n.currentTime+.26),g.start(),g.stop(n.currentTime+.28)}catch{}},E=async()=>{if(m.value)return;m.value=new AudioContext;const e=m.value,t=e.createGain();t.gain.value=.35;const n=new StereoPannerNode(e,{pan:0});n.connect(t).connect(e.destination),b.value=t,T.value=n},M=(e,t)=>Math.floor(Math.random()*(t-e+1))+e,V=()=>{const e=[];for(;e.length<k;){const t=M(0,v-1),n=M(0,v-1);Math.abs(t-l.value)+Math.abs(n-c.value)<4||e.some(o=>o.x===t&&o.y===n)||e.push({x:t,y:n,found:!1})}p.value=e},N=y(()=>{const e=p.value.filter(s=>!s.found);if(e.length===0)return null;let t=e[0],n=1/0;for(const s of e){const o=Math.abs(s.x-l.value)+Math.abs(s.y-c.value);o<n&&(n=o,t=s)}return{target:t,dist:n}}),D=y(()=>p.value.some(e=>!e.found&&e.x===l.value&&e.y===c.value)),I=y(()=>d.value===null?"—":d.value===0?"here":d.value<=2?"very close":d.value<=5?"close":d.value<=9?"far":"very far"),_=(e,t)=>{const n=l.value+e,s=c.value+t;if(n<0||s<0||n>=v||s>=v){u.value="Wall. You cannot go further.";return}l.value=n,c.value=s,w.value++,u.value="Step."},P=async()=>{await E();const e=N.value;if(!e){u.value="No targets left.";return}d.value=e.dist;const t=e.target.x-l.value,n=Math.max(-1,Math.min(1,t/4));u.value="Ping… follow the sound.",C(e.dist,n)},B=()=>{const e=p.value.find(t=>!t.found&&t.x===l.value&&t.y===c.value);if(!e){u.value="Nothing here.";return}e.found=!0,u.value="Found it.",d.value=0,typeof window<"u"&&window.dispatchEvent(new CustomEvent("blindsite:achievement",{detail:{key:"finder",text:"Seeker: you found a target by sound."}})),x.value>=k&&(u.value=`All targets found in ${w.value} moves. Great job.`,typeof window<"u"&&window.dispatchEvent(new CustomEvent("blindsite:achievement",{detail:{key:"caneMaster",text:"Cane master: you completed the audio hunt."}})))},G=e=>{switch(e.key){case"ArrowUp":_(0,-1);break;case"ArrowDown":_(0,1);break;case"ArrowLeft":_(-1,0);break;case"ArrowRight":_(1,0);break;case" ":case"Spacebar":P();break;case"Enter":B();break}};return U(()=>{V(),typeof window<"u"&&window.dispatchEvent(new CustomEvent("blindsite:achievement",{detail:{key:"cane",text:"Navigator: you started the cane audio hunt."}}))}),(e,t)=>(S(),A("section",F,[t[4]||(t[4]=a("header",{class:"stick-page__header"},[a("h1",{class:"stick-page__title"},"Cane Simulation (Audio Hunt)"),a("p",{class:"stick-page__lead"}," Find hidden targets using sound only. Your cane sends a “ping” and you must follow the audio cue (volume + stereo pan) to locate the target. "),a("p",{class:"stick-page__instructions"},[r(" Use "),a("strong",null,"arrow keys"),r(" to move. Press "),a("strong",null,"Space"),r(" to ping. When you think you’re on the target tile, press "),a("strong",null,"Enter"),r(" to “pick up” the target. ")])],-1)),a("main",K,[a("section",{class:"stick-page__arena",tabindex:"0",role:"application","aria-label":"Audio hunt cane game. Arrow keys to move. Space to ping. Enter to pick up the target.",onKeydown:W(G,["prevent"])},[a("div",O,[a("div",j,[a("span",null,[t[0]||(t[0]=r("Targets found: ",-1)),a("strong",null,f(x.value),1),r(" / "+f(k))]),a("span",null,[t[1]||(t[1]=r("Moves: ",-1)),a("strong",null,f(w.value),1)])]),a("div",q,[a("span",null,[t[2]||(t[2]=r("Last ping distance: ",-1)),a("strong",null,f(I.value),1)]),D.value?(S(),A("span",H,"Target is here")):Y("",!0)])]),a("p",X,f(u.value),1),a("div",J,[a("div",{class:"mini__dot",style:$({left:`${l.value/(v-1)*100}%`,top:`${c.value/(v-1)*100}%`})},null,4)])],32),t[3]||(t[3]=a("section",{class:"stick-page__notes"},[a("h2",null,"What this tries to show"),a("p",null," In real life, people learn to map space through sound, touch and repetition. This mini-game exaggerates that: you must build a mental map and use audio cues to navigate. ")],-1))])]))}}),te=z(Q,[["__scopeId","data-v-f7e6e224"]]);export{te as default};
