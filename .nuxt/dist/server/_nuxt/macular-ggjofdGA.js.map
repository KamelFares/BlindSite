{"version":3,"file":"macular-ggjofdGA.js","sources":["../../../../app/pages/macular.vue"],"sourcesContent":["<template>\r\n  <section class=\"macular\">\r\n    <header class=\"macular__header\">\r\n      <h1 class=\"macular__title\">Macular Degeneration Simulation</h1>\r\n      <p class=\"macular__lead\">\r\n        Macular degeneration can affect central vision. People may see a blur or\r\n        dark spot in the center while peripheral vision remains.\r\n      </p>\r\n\r\n      <div class=\"controls\">\r\n        <label class=\"controls__label\" for=\"difficulty\">\r\n          Difficulty: <strong>{{ difficultyLabel }}</strong>\r\n        </label>\r\n        <select id=\"difficulty\" class=\"controls__select\" v-model=\"difficulty\">\r\n          <option value=\"easy\">Easy</option>\r\n          <option value=\"normal\">Normal</option>\r\n          <option value=\"hard\">Hard</option>\r\n        </select>\r\n\r\n        <label class=\"controls__label\" for=\"size\">\r\n          Central spot size: <strong>{{ spotSize }}</strong>\r\n        </label>\r\n        <input\r\n          id=\"size\"\r\n          class=\"controls__range\"\r\n          type=\"range\"\r\n          min=\"80\"\r\n          max=\"260\"\r\n          step=\"10\"\r\n          v-model.number=\"spotSize\"\r\n        />\r\n      </div>\r\n    </header>\r\n\r\n    <main class=\"macular__main\">\r\n      <section class=\"game\" aria-label=\"Peripheral vision game\">\r\n        <div class=\"game__top\" aria-live=\"polite\">\r\n          <p class=\"game__prompt\">\r\n            Task: Click the target shape <strong>{{ targetShape }}</strong>.\r\n          </p>\r\n          <p class=\"game__score\">\r\n            Score: <strong>{{ score }}</strong>\r\n            | Misses: <strong>{{ misses }}</strong>\r\n            | Time: <strong>{{ timeLeft }}</strong>s\r\n          </p>\r\n        </div>\r\n\r\n        <div class=\"stage\" @click=\"onStageClick\" :style=\"stageStyle\">\r\n          <div class=\"spot\" aria-hidden=\"true\" />\r\n\r\n          <button\r\n            v-for=\"item in items\"\r\n            :key=\"item.id\"\r\n            type=\"button\"\r\n            class=\"item\"\r\n            :class=\"{ 'item--target': item.shape === targetShape }\"\r\n            :style=\"{ left: `${item.x}px`, top: `${item.y}px` }\"\r\n            @click.stop=\"pick(item)\"\r\n            :aria-label=\"`Shape ${item.shape}`\"\r\n          >\r\n            <span aria-hidden=\"true\">{{ item.shape }}</span>\r\n          </button>\r\n        </div>\r\n\r\n        <p class=\"game__hint\">\r\n          Hint: The center is blocked. Use the edges of the screen to spot the\r\n          shapes and move your eyes around.\r\n        </p>\r\n      </section>\r\n\r\n      <section class=\"info\">\r\n        <h2>Why this is hard</h2>\r\n        <p>\r\n          When central vision is affected, details in the middle can disappear.\r\n          Reading, face recognition, and small targets can become difficult.\r\n          People often learn to use a “preferred retinal location” by looking\r\n          slightly away from what they want to see.\r\n        </p>\r\n      </section>\r\n    </main>\r\n  </section>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { computed, onMounted, onUnmounted, ref, watch } from 'vue'\r\n\r\ntype Item = {\r\n  id: number\r\n  x: number\r\n  y: number\r\n  shape: string\r\n}\r\n\r\nconst spotSize = ref(160)\r\nconst score = ref(0)\r\nconst misses = ref(0)\r\nconst targetShape = ref('▲')\r\nconst items = ref<Item[]>([])\r\n\r\ntype Difficulty = 'easy' | 'normal' | 'hard'\r\nconst difficulty = ref<Difficulty>('normal')\r\nconst timeLeft = ref(25)\r\nlet timer: number | null = null\r\n\r\nconst difficultyLabel = computed(() => {\r\n  if (difficulty.value === 'easy') return 'Easy'\r\n  if (difficulty.value === 'hard') return 'Hard'\r\n  return 'Normal'\r\n})\r\n\r\nconst shapes = ['▲', '●', '■', '◆', '✚']\r\n\r\nconst randomBetween = (min: number, max: number) => Math.random() * (max - min) + min\r\n\r\nconst config = computed(() => {\r\n  switch (difficulty.value) {\r\n    case 'easy':\r\n      return { count: 12, size: 56, padding: 18, start: 30, penalty: 1 }\r\n    case 'hard':\r\n      return { count: 22, size: 38, padding: 16, start: 18, penalty: 2 }\r\n    default:\r\n      return { count: 16, size: 48, padding: 18, start: 25, penalty: 1 }\r\n  }\r\n})\r\n\r\nconst stageStyle = computed(() => ({\r\n  '--spot-size': `${spotSize.value}px`,\r\n  '--item-size': `${config.value.size}px`,\r\n}))\r\n\r\nconst layout = () => {\r\n  if (typeof window === 'undefined') return\r\n\r\n  const w = Math.min(900, window.innerWidth - 80)\r\n  const h = 420\r\n  const padding = config.value.padding\r\n\r\n  const next: Item[] = []\r\n  for (let i = 0; i < config.value.count; i++) {\r\n    next.push({\r\n      id: i,\r\n      x: randomBetween(padding, w - padding),\r\n      y: randomBetween(padding, h - padding),\r\n      shape: shapes[Math.floor(Math.random() * shapes.length)],\r\n    })\r\n  }\r\n\r\n  items.value = next\r\n  targetShape.value = shapes[Math.floor(Math.random() * shapes.length)]\r\n}\r\n\r\nconst resetTimer = () => {\r\n  timeLeft.value = config.value.start\r\n  if (timer) window.clearInterval(timer)\r\n  timer = window.setInterval(() => {\r\n    timeLeft.value -= 1\r\n    if (timeLeft.value <= 0) {\r\n      // Timeout: new round + penalty\r\n      misses.value += config.value.penalty\r\n      resetTimer()\r\n      layout()\r\n    }\r\n  }, 1000)\r\n}\r\n\r\nconst pick = (item: Item) => {\r\n  if (item.shape === targetShape.value) {\r\n    score.value++\r\n    // reward: add a little time on harder modes\r\n    timeLeft.value = Math.min(config.value.start, timeLeft.value + 2)\r\n    layout()\r\n  } else {\r\n    misses.value += config.value.penalty\r\n  }\r\n}\r\n\r\nconst onStageClick = () => {\r\n  // Misclick in the dark\r\n  misses.value += config.value.penalty\r\n}\r\n\r\nonMounted(() => {\r\n  layout()\r\n  resetTimer()\r\n\r\n  // Hidden achievement: visiting the macular simulation\r\n  if (typeof window !== 'undefined') {\r\n    window.dispatchEvent(\r\n      new CustomEvent('blindsite:achievement', {\r\n        detail: {\r\n          key: 'macular',\r\n          text: 'Central vision: you reached the macular degeneration simulation.',\r\n        },\r\n      })\r\n    )\r\n  }\r\n})\r\n\r\nonUnmounted(() => {\r\n  if (timer) window.clearInterval(timer)\r\n})\r\n\r\nwatch(difficulty, () => {\r\n  // Make harder modes also increase scotoma by default\r\n  if (difficulty.value === 'hard') spotSize.value = Math.max(spotSize.value, 190)\r\n  resetTimer()\r\n  layout()\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.macular {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 2.5rem;\r\n}\r\n\r\n.macular__header {\r\n  display: grid;\r\n  gap: 1rem;\r\n  max-width: 52rem;\r\n}\r\n\r\n.macular__title {\r\n  font-size: clamp(2.2rem, 3.5vw, 2.8rem);\r\n}\r\n\r\n.macular__lead {\r\n  color: #e5e7eb;\r\n  line-height: 1.6;\r\n}\r\n\r\n.controls {\r\n  display: grid;\r\n  gap: 0.35rem;\r\n  max-width: 28rem;\r\n}\r\n\r\n.controls__select {\r\n  width: 100%;\r\n  border-radius: 0.75rem;\r\n  border: 1px solid rgba(148, 163, 184, 0.45);\r\n  background: rgba(15, 23, 42, 0.65);\r\n  color: #e5e7eb;\r\n  padding: 0.55rem 0.65rem;\r\n}\r\n\r\n.controls__label {\r\n  color: #e5e7eb;\r\n}\r\n\r\n.controls__range {\r\n  width: 100%;\r\n}\r\n\r\n.macular__main {\r\n  display: grid;\r\n  gap: 2.5rem;\r\n}\r\n\r\n.game {\r\n  max-width: 52rem;\r\n}\r\n\r\n.game__top {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  justify-content: space-between;\r\n  gap: 0.75rem;\r\n  color: #e5e7eb;\r\n  margin-bottom: 0.75rem;\r\n}\r\n\r\n.stage {\r\n  position: relative;\r\n  border-radius: 1rem;\r\n  border: 1px solid rgba(148, 163, 184, 0.4);\r\n  /* More relatable: the game area is NOT pitch black so the central scotoma is visible */\r\n  background: radial-gradient(circle at 30% 20%, rgba(255, 255, 255, 0.10), rgba(255, 255, 255, 0.03) 45%, rgba(0, 0, 0, 0.0) 70%),\r\n    linear-gradient(180deg, rgba(255, 255, 255, 0.06), rgba(255, 255, 255, 0.02));\r\n  height: 420px;\r\n  overflow: hidden;\r\n}\r\n\r\n.spot {\r\n  position: absolute;\r\n  left: 50%;\r\n  top: 50%;\r\n  width: var(--spot-size);\r\n  height: var(--spot-size);\r\n  transform: translate(-50%, -50%);\r\n  border-radius: 999px;\r\n  /* Scotoma: looks like a blurry/washed-out spot with a darker core */\r\n  background:\r\n    radial-gradient(circle, rgba(0, 0, 0, 0.75) 0, rgba(0, 0, 0, 0.55) 45%, rgba(0, 0, 0, 0.0) 72%),\r\n    radial-gradient(circle, rgba(255, 255, 255, 0.14) 0, rgba(255, 255, 255, 0.0) 65%);\r\n  filter: blur(2px) contrast(1.05);\r\n  pointer-events: none;\r\n}\r\n\r\n.spot::after {\r\n  content: '';\r\n  position: absolute;\r\n  inset: -16px;\r\n  border-radius: 999px;\r\n  background: radial-gradient(circle, rgba(255, 255, 255, 0.10), rgba(255, 255, 255, 0.0) 70%);\r\n  filter: blur(10px);\r\n  opacity: 0.55;\r\n}\r\n\r\n.item {\r\n  position: absolute;\r\n  width: var(--item-size, 54px);\r\n  height: var(--item-size, 54px);\r\n  border-radius: 14px;\r\n  border: 1px solid rgba(148, 163, 184, 0.6);\r\n  background: rgba(15, 23, 42, 0.75);\r\n  color: #e5e7eb;\r\n  display: grid;\r\n  place-items: center;\r\n  cursor: pointer;\r\n  font-size: 1.6rem;\r\n}\r\n\r\n.item:hover,\r\n.item:focus-visible {\r\n  border-color: rgba(251, 191, 36, 0.9);\r\n  outline: none;\r\n}\r\n\r\n.game__hint {\r\n  margin-top: 0.75rem;\r\n  color: #e5e7eb;\r\n  opacity: 0.9;\r\n}\r\n\r\n.info {\r\n  max-width: 52rem;\r\n  color: #e5e7eb;\r\n  line-height: 1.6;\r\n}\r\n\r\n.info h2 {\r\n  font-size: 1.3rem;\r\n  margin-bottom: 0.5rem;\r\n}\r\n</style>\r\n"],"names":["_ssrRenderAttrs","_mergeProps","_ssrRenderList","_ssrRenderStyle","_ssrInterpolate"],"mappings":";;;;;;;;;;;;;;;;;;;AA6FA,UAAM,WAAW,IAAI,GAAG;AACxB,UAAM,QAAQ,IAAI,CAAC;AACnB,UAAM,SAAS,IAAI,CAAC;AACpB,UAAM,cAAc,IAAI,GAAG;AAC3B,UAAM,QAAQ,IAAY,EAAE;AAG5B,UAAM,aAAa,IAAgB,QAAQ;AAC3C,UAAM,WAAW,IAAI,EAAE;AACvB,QAAI,QAAuB;AAE3B,UAAM,kBAAkB,SAAS,MAAM;AACrC,UAAI,WAAW,UAAU,OAAQ,QAAO;AACxC,UAAI,WAAW,UAAU,OAAQ,QAAO;AACxC,aAAO;AAAA,IACT,CAAC;AAMD,UAAM,SAAS,SAAS,MAAM;AAC5B,cAAQ,WAAW,OAAA;AAAA,QACjB,KAAK;AACH,iBAAO,EAAE,OAAO,IAAI,MAAM,IAAI,SAAS,IAAI,OAAO,IAAI,SAAS,EAAA;AAAA,QACjE,KAAK;AACH,iBAAO,EAAE,OAAO,IAAI,MAAM,IAAI,SAAS,IAAI,OAAO,IAAI,SAAS,EAAA;AAAA,QACjE;AACE,iBAAO,EAAE,OAAO,IAAI,MAAM,IAAI,SAAS,IAAI,OAAO,IAAI,SAAS,EAAA;AAAA,MAAE;AAAA,IAEvE,CAAC;AAED,UAAM,aAAa,SAAS,OAAO;AAAA,MACjC,eAAe,GAAG,SAAS,KAAK;AAAA,MAChC,eAAe,GAAG,OAAO,MAAM,IAAI;AAAA,IAAA,EACnC;AAuBF,UAAM,aAAa,MAAM;AACvB,eAAS,QAAQ,OAAO,MAAM;AAC9B,UAAI,MAAO,CAAA,SAAO,cAAc,KAAK;AACrC,cAAQ,SAAO,YAAY,MAAM;AAC/B,iBAAS,SAAS;AAClB,YAAI,SAAS,SAAS,GAAG;AAEvB,iBAAO,SAAS,OAAO,MAAM;AAC7B,qBAAA;AAAA,QAEF;AAAA,MACF,GAAG,GAAI;AAAA,IACT;AAuCA,UAAM,YAAY,MAAM;AAEtB,UAAI,WAAW,UAAU,OAAQ,UAAS,QAAQ,KAAK,IAAI,SAAS,OAAO,GAAG;AAC9E,iBAAA;AAAA,IAEF,CAAC;;uBA9MUA,eAAAC,WAAA,EAAA,OAAM,aAAS,MAAA,CAAA,8dAUO,gBAAA,KAAe,8JAEkB,WAAA,KAAU,oBAAV,WAAA,OAAU,MAAA,kBAAV,WAAA,OAAU,MAAA,CAAA,IAAA,cAAA,6FAAV,WAAA,KAAU,oBAAV,WAAA,OAAU,QAAA,kBAAV,WAAA,OAAU,QAAA,CAAA,IAAA,cAAA,6FAAV,WAAA,KAAU,oBAAV,WAAA,OAAU,MAAA,kBAAV,WAAA,OAAU,MAAA,CAAA,IAAA,cAAA,iJAOpC,SAAA,KAAQ,8HAStB,SAAA,KAAQ,iUASkB,YAAA,KAAW,yGAGjC,MAAA,KAAK,+DACF,OAAA,KAAM,6DACR,SAAA,KAAQ,kEAIkB,WAAA,KAAU;AAIxCC,oBAAA,MAAA,QAAR,SAAI;gFAIe,KAAK,UAAU,YAAA,MAAA,GAAW,MAAA,CAAA,aACjCC,eAAA,EAAA,MAAA,GAAA,KAAK,CAAC,MAAA,KAAA,GAAc,KAAK,CAAC,MAAA,mBAE5C,cAAU,SAAW,KAAK,KAAK,EAAA,8DAEJC,eAAA,KAAK,KAAK;;;;;;;;;;;;;"}